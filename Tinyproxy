#!/bin/bash

# Script to display external IPv4 address and provide network access setup for Tinyproxy

# Detect external IPv4 address
EXTERNAL_IP=$(curl -4 -s https://api.ipify.org)

# Display external IP address
echo "External IPv4 Address: $EXTERNAL_IP"

# Display usage commands for clients
echo "Usage Commands for Clients:"
echo "1. To configure your client:"
echo "   Set your proxy server to $EXTERNAL_IP on port [PORT]"
echo "2. To check your connection:"
echo "   curl -x http://$EXTERNAL_IP:[PORT] http://example.com"

# Setup instructions for client network access
echo "Client Network Access Setup:"
echo "1. Ensure your firewall allows traffic on port [PORT]."
echo "2. Use the following command to allow access from a specific client IP:"
echo "   iptables -A INPUT -p tcp --dport [PORT] -s <client-ip> -j ACCEPT"
echo "3. Replace <client-ip> with the actual IP address of the client."

# Note: Ensure to replace [PORT] with the actual port number you are using for Tinyproxy