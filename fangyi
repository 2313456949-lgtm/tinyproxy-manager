#!/bin/bash

# ==========================================
# 多语言配置
# ==========================================
declare -A msg

# 英文文本
msg[en_title]="--- VPS Panel Installer ---"
msg[en_choice]="Please choose a panel to install:"
msg[en_installing]="Installing"
msg[en_done]="Installation completed successfully!"
msg[en_error]="Invalid option. Exiting."
msg[en_exit]="Exit"
msg[en_panel1]="aaPanel (International)"
msg[en_panel2]="1Panel (Chinese Native)"

# 中文文本
msg[zh_title]="--- VPS 面板安装工具 ---"
msg[zh_choice]="请选择要安装的面板："
msg[zh_installing]="正在安装"
msg[zh_done]="安装完成！"
msg[zh_error]="无效选项，退出。"
msg[zh_exit]="退出"
msg[zh_panel1]="aaPanel (国际版)"
msg[zh_panel2]="1Panel (国内版)"

# ==========================================
# 自动检测系统语言
# ==========================================
if [[ "$LANG" == *zh* ]] || [[ "$LANG" == *CN* ]]; then
    CONF_LANG="zh"
else
    CONF_LANG="en"
fi

# 翻译函数
t() {
    local key="${CONF_LANG}_$1"
    echo "${msg[$key]}"
}

# ==========================================
# 功能函数
# ==========================================
install_aaPanel() {
    echo "$(t installing) aaPanel..."
    if bash <(curl -s http://www.aapanel.com/script/install_6.0_en.sh); then
        echo "✓ aaPanel $(t done)"
        return 0
    else
        echo "✗ aaPanel 安装失败！"
        return 1
    fi
}

install_1Panel() {
    echo "$(t installing) 1Panel..."
    if bash <(curl -sSL https://resource.fit2cloud.com/1panel/package/quick_start.sh); then
        echo "✓ 1Panel $(t done)"
        return 0
    else
        echo "✗ 1Panel 安装失败！"
        return 1
    fi
}

# ==========================================
# 主菜单
# ==========================================
main_menu() {
    clear
    echo "$(t title)"
    echo ""
    echo "1) $(t panel1)"
    echo "2) $(t panel2)"
    echo "0) $(t exit)"
    echo ""
    read -p "$(t choice) [0-2]: " opt
    
    case $opt in
        1) install_aaPanel ;;
        2) install_1Panel ;;
        0) echo "Bye!"; exit 0 ;;
        *) echo "$(t error)"; exit 1 ;;
    esac
}

# ==========================================
# 执行
# ==========================================
main_menu
